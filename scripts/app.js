!function(t){function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){var n,r;n=[e,i,e(1)],r=function(t,i,e){"use strict";var n=document.getElementById("js-stage");new e.Platformer({elem:n,ctx:n.getContext("2d"),width:512,height:288})}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i,e(2),e(3),e(4),e(10),e(11)],r=function(t,i,e,n,r,o,s){"use strict";var h=function(){function t(t){this.canvas=t,t.elem.width=t.width,t.elem.height=t.height,this.stage=new n.Stage(t.ctx),this.stage.outerWidth=t.width,this.stage.outerHeight=t.height,this.stage.innerWidth=3*t.width,this.stage.innerHeight=t.height,this.stage.xTranslateStart=t.width/2,this.stage.xTranslateEnd=this.stage.innerWidth-t.width/2,this.protagonist=new r.Character(t.ctx),this.protagonist.y=this.stage.innerHeight/2-this.protagonist.height,this.protagonist.fillStyle="indianred",this.isJumpKeyPressed=!1,this.isShootKeyPressed=!1,this._endLoop=!1,this._endLoopCount=0,this.bind().setObstacleArr().setAntagonistArray().update()}return t.prototype.setObstacleArr=function(){var t=this,i=this,e=i.stage,n=i.canvas,r=[{x:0,y:e.innerHeight-10,width:e.innerWidth,height:20},{x:-20,y:0,width:20,height:e.innerHeight},{x:e.innerWidth+20,y:0,width:20,height:e.innerHeight},{x:40,y:e.innerHeight-70,width:40,height:60},{x:280,y:e.innerHeight-70,width:40,height:60},{x:320,y:e.innerHeight-30,width:100,height:20,fillStyle:"red",canKill:!0}];return this.obstacleArr=[],r.forEach(function(i){var e=new s.Obstacle(n.ctx);e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height,i.fillStyle&&(e.fillStyle=i.fillStyle),i.canKill&&(e.canKill=i.canKill),t.obstacleArr.push(e)}),this},t.prototype.setAntagonistArray=function(){var t=this,i=this,e=(i.stage,i.canvas),n=[{y:this.stage.innerHeight-30,x:80,canJump:!0,canShoot:!0,canMove:!0},{y:this.stage.innerHeight-30,x:120,canMove:!0,lastMove:"left",fillStyle:"gray"}];return this.antagonistArr=[],n.forEach(function(i){var n=new o.Antagonist(e.ctx);n.x=i.x,n.y=i.y,i.lastMove&&(n.lastMove=i.lastMove),i.canMove&&(n.canMove=i.canMove),i.canJump&&(n.canJump=i.canJump),i.canShoot&&(n.canShoot=i.canShoot),i.fillStyle&&(n.fillStyle=i.fillStyle),t.antagonistArr.push(n)}),this},t.prototype.bind=function(){var t=this;return document.addEventListener("keydown",function(i){t.onkeydown(i)},!1),document.addEventListener("keyup",function(i){t.onkeyup(i)},!1),this},t.prototype.onkeydown=function(t){var i=this.protagonist,e=t.keyCode;39===e&&i.move("right"),37===e&&i.move("left"),38!==e&&32!==e||this.isJumpKeyPressed||(i.jump(),this.isJumpKeyPressed=!0),90===e&&(this.isShootKeyPressed||(i.shoot(),this.isShootKeyPressed=!0))},t.prototype.onkeyup=function(t){var i=this.protagonist,e=t.keyCode;39===e&&i.stopMove("right"),37===e&&i.stopMove("left"),38!==e&&32!==e||(this.isJumpKeyPressed=!1),90===e&&(this.isShootKeyPressed=!1)},t.prototype.update=function(){var t=this,i=this,n=i.canvas,r=i.stage,o=i.protagonist,s=i.antagonistArr,h=i.obstacleArr;if(n.ctx.clearRect(-r.x,r.y,r.outerWidth,r.outerHeight),o.update(),o.bulletArr.forEach(function(t){t.update()}),o.bulletArr.forEach(function(i,e){t.cleanBulletArr(o.bulletArr,e,i).checkForShotCharacter(i,s).checkForBulletCollision(i,h)}),s.forEach(function(i){i.update(),i.bulletArr.forEach(function(t){t.update()}),i.bulletArr.forEach(function(e,n){t.cleanBulletArr(i.bulletArr,n,e).checkForShotCharacter(e,[o]).checkForBulletCollision(e,h)})}),h.forEach(function(t){var i=e.checkForCollision(o,t,!0);"object"==typeof i&&(o.collisionHandler(i.side,i.depth),t.canKill&&o.kill()),s.forEach(function(i){var n=e.checkForCollision(i,t,!0);if("object"==typeof n&&i.collisionHandler(n.side,n.depth),!i.isDeath){var r=e.checkForCollision(o,i);r&&(o.kill(),i.kill())}}),t.render()}),s.forEach(function(t){t.bulletArr.forEach(function(t){t.render()}),t.render()}),o.bulletArr.forEach(function(t){t.render()}),o.render(),r.x=o.x,r.render(),this._endLoop){if(this._endLoopCount===this.protagonist.clearWait-2)return location.reload(),this;this._endLoopCount++}return this._endLoop=this.protagonist.isDeath,requestAnimationFrame(this.update.bind(this)),this},t.prototype.cleanBulletArr=function(t,i,e){var n=this,r=(n.canvas,n.stage);return(e.remove||e.x<-r.x||e.x>-r.x+r.outerWidth)&&t.splice(i,1),this},t.prototype.checkForShotCharacter=function(t,i){var e=this;return i.forEach(function(i){i.isDeath||e.checkForBulletCollision(t,[i],function(t){t.kill()})}),this},t.prototype.checkForBulletCollision=function(t,i,n){return i.forEach(function(i){var r=e.checkForCollision(t,i,!0);"object"==typeof r&&(t.collisionHandler(r.side,r.depth),"function"==typeof n&&n(i))}),this},t}();i.Platformer=h}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i],r=function(t,i){"use strict";function e(t,i,e){void 0===e&&(e=!1);var n=t.x+t.width/2-(i.x+i.width/2),r=t.y+t.height/2-(i.y+i.height/2),o=(t.width+i.width)/2,s=(t.height+i.height)/2;if(Math.abs(n)<o&&Math.abs(r)<s){if(e){var h=o-Math.abs(n),a=s-Math.abs(r);return h>=a?{side:r>0?"top":"bottom",depth:a}:{side:n>0?"left":"right",depth:h}}return!0}return!1}i.checkForCollision=e}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i],r=function(t,i){"use strict";var e=function(){function t(t){this.context=t,this.y=0,this.outerWidth=0,this.outerHeight=0,this.innerWidth=0,this.innerHeight=0,this.xTranslateStart=0,this.xTranslateEnd=0,this._x=0}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){var i=this,e=i.xTranslateStart,n=i.xTranslateEnd,r=i.outerWidth,o=i.innerWidth;t>e?t>n?this._x=r-o:this._x=e-t:this._x=0},enumerable:!0,configurable:!0}),t.prototype.render=function(){var t=this.context;return t.setTransform(1,0,0,1,0,0),t.translate(this.x,0),this},t}();i.Stage=e}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r,o=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)};n=[e,i,e(5),e(6),e(7),e(8),e(9)],r=function(t,i,e,n,r,s,h){"use strict";var a=function(t){function i(i){var n=t.call(this,i)||this;n.context=i,n.friction=.75,n.xSpeed=4,n.ySpeed=8,n.clearWait=25,n.lastMove="right",n.fillStyle="black",n.spriteFrames={defaultRight:[0,0],defaultLeft:[0,16],deathRight:[14,0],deathLeft:[14,16]},n._xVel=0,n._yVel=0,n._isDeath=!1,n._isJumping=!1,n._isMovingLeft=!1,n._isMovingRight=!1,n._clearWaitCount=0,n._bulletArr=[],n.width=20,n.height=30;var o=e.IS_HIDPI?"js-sprite-2x":"js-sprite-1x";return n.sprite=new r.Sprite(i),n.sprite.img=document.getElementById(o),n.sprite.width=14,n.sprite.height=16,n}return o(i,t),Object.defineProperty(i.prototype,"xVel",{get:function(){return this._xVel},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"yVel",{get:function(){return this._yVel},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isDeath",{get:function(){return this._isDeath},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isJumping",{get:function(){return this._isJumping},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isMovingLeft",{get:function(){return this._isMovingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isMovingRight",{get:function(){return this._isMovingRight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bulletArr",{get:function(){return this._bulletArr},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clearWaitCount",{get:function(){return this._clearWaitCount},enumerable:!0,configurable:!0}),i.prototype.kill=function(){return this.stopMove(),this._xVel=0,this._isJumping=!1,this._yVel=0,this._isDeath=!0,this},i.prototype.move=function(t){return this._isDeath||(this._isMovingLeft="left"===t,this._isMovingRight="right"===t,this.lastMove=t),this},i.prototype.stopMove=function(t,i){return void 0===i&&(i=!1),this._isMovingRight=!(!t||"right"===t)&&this._isMovingRight,this._isMovingLeft=!(!t||"left"===t)&&this._isMovingLeft,this},i.prototype.jump=function(){return this._isJumping||0!==this._yVel||(this._isJumping=!0,this._yVel-=this.ySpeed),this},i.prototype.shoot=function(){var t=this,i=t.context,e=t.x,n=t.y,r=t.width,o=t.height,s=new h.Bullet(i);return s.x=e+r/2-s.width/2,s.y=n+o/2-s.height/2,s.move(this.lastMove),this._bulletArr.push(s),this},i.prototype.update=function(){return this._isDeath||(this._isMovingRight?this._xVel<this.xSpeed&&this._xVel++:this._isMovingLeft?this._xVel>-this.xSpeed&&this._xVel--:0!==this._xVel&&(Math.abs(this._xVel)<.05?this._xVel=0:this._xVel*=this.friction),this._yVel+=s.GRAVITY,this.x+=this._xVel,this.y+=this._yVel),this},i.prototype.collisionHandler=function(t,i){if(!this._isDeath){switch(t){case"left":this.x+=i;break;case"right":this.x-=i;break;case"top":this.y+=i,this._yVel=0;break;case"bottom":this.y-=i}"left"!==t&&"right"!==t||(this._xVel=0),"bottom"===t&&this._yVel>0&&(this._yVel=0,this._isJumping&&(this._isJumping=!1))}return this},i.prototype.render=function(){var i=this,e=i.context;i._bulletArr;if(this._isDeath){if(this._clearWaitCount===this.clearWait)return this;this._clearWaitCount++}return e.fillStyle=this.fillStyle,t.prototype.render.call(this),e.fill(),this.renderFace(),this},i.prototype.renderFace=function(){var t=this,i=(t.context,t.sprite),e=t.lastMove,n=t.spriteFrames;return i.yPosition=this.y,i.xPosition=this.x,"right"===e&&(i.xPosition+=this.width-i.width),this.isDeath?"right"===e?(i.xOrigin=n.deathRight[0],i.yOrigin=n.deathRight[1]):(i.xOrigin=n.deathLeft[0],i.yOrigin=n.deathLeft[1]):"right"===e?(i.xOrigin=n.defaultRight[0],i.yOrigin=n.defaultRight[1]):(i.xOrigin=n.defaultLeft[0],i.yOrigin=n.defaultLeft[1]),i.render(),this},i}(n.Rect);i.Character=a}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i],r=function(t,i){"use strict";i.IS_HIDPI=window.devicePixelRatio>1}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i],r=function(t,i){"use strict";var e=function(){function t(t){this.context=t,this.x=0,this.y=0,this.width=0,this.height=0}return t.prototype.render=function(){var t=this.context;return t.beginPath(),t.rect(this.x,this.y,this.width,this.height),this},t}();i.Rect=e}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i,e(5)],r=function(t,i,e){"use strict";var n=function(){function t(t){this.context=t,this.xOrigin=0,this.yOrigin=0,this.xPosition=0,this.yPosition=0,this.width=0,this.height=0}return t.prototype.render=function(){var t=this,i=t.xOrigin,n=t.yOrigin,r=t.xPosition,o=t.yPosition,s=t.width,h=t.height,a=e.IS_HIDPI?2*i:i,l=e.IS_HIDPI?2*n:n,c=e.IS_HIDPI?2*s:s,u=e.IS_HIDPI?2*h:h;return this.context.drawImage(this.img,a,l,c,u,r,o,s,h),this},t}();i.Sprite=n}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r;n=[e,i],r=function(t,i){"use strict";i.GRAVITY=.4}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r,o=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)};n=[e,i,e(6)],r=function(t,i,e){"use strict";var n=function(t){function i(i){var e=t.call(this,i)||this;return e.context=i,e.xSpeed=12,e.remove=!1,e.fillStyle="white",e._isMovingLeft=!1,e._isMovingRight=!1,e._firstUpdate=!0,e.width=8,e.height=8,e}return o(i,t),Object.defineProperty(i.prototype,"isMovingLeft",{get:function(){return this._isMovingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isMovingRight",{get:function(){return this._isMovingRight},enumerable:!0,configurable:!0}),i.prototype.move=function(t){return this._isMovingLeft="left"===t,this._isMovingRight="right"===t,this},i.prototype.stopMove=function(t,i){return void 0===i&&(i=!1),this._isMovingRight=!(!t||"right"===t)&&this._isMovingRight,this._isMovingLeft=!(!t||"left"===t)&&this._isMovingLeft,this},i.prototype.update=function(){return this._firstUpdate?this._firstUpdate=!1:this.x+=this._isMovingRight?this.xSpeed:-this.xSpeed,this},i.prototype.collisionHandler=function(t,i){return"left"===t&&(this.x+=i),"right"===t&&(this.x-=i),this.remove=!0,this},i.prototype.render=function(){var i=this.context;return i.fillStyle=this.fillStyle,t.prototype.render.call(this),i.fill(),this},i}(e.Rect);i.Bullet=n}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r,o=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)};n=[e,i,e(4)],r=function(t,i,e){"use strict";var n=function(t){function i(i){var e=t.call(this,i)||this;return e.context=i,e.canJump=!1,e.canShoot=!1,e.shootWait=50,e.jumpWait=10,e._canMove=!1,e._shootWaitCount=0,e._jumpWaitCount=0,e.ySpeed=6,e.xSpeed=.25,e.fillStyle="red",e.spriteFrames={defaultRight:[28,0],defaultLeft:[28,16],deathRight:[42,0],deathLeft:[42,16]},e.canJump=!1,e.jumpWait=25,e._jumpWaitCount=0,e}return o(i,t),Object.defineProperty(i.prototype,"canMove",{get:function(){return this._canMove},set:function(t){this.move(this.lastMove),this._canMove=!0},enumerable:!0,configurable:!0}),i.prototype.update=function(){return this.isDeath||(this.canJump&&!this._isJumping&&this._jumpWaitCount++===this.jumpWait&&(this.jump(),this._jumpWaitCount=0),this.canShoot&&this._shootWaitCount++===this.shootWait&&(this.shoot(),this._shootWaitCount=0)),t.prototype.update.call(this),this},i.prototype.collisionHandler=function(i,e){return t.prototype.collisionHandler.call(this,i,e),this._isDeath||("right"===i&&this.move("left"),"left"===i&&this.move("right")),this},i}(e.Character);i.Antagonist=n}.apply(i,n),!(void 0!==r&&(t.exports=r))},function(t,i,e){var n,r,o=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)};n=[e,i,e(6)],r=function(t,i,e){"use strict";var n=function(t){function i(i){var e=t.call(this,i)||this;return e.context=i,e.canKill=!1,e.fillStyle="black",e.fillStyle="black",e}return o(i,t),i.prototype.render=function(){var i=this.context;return i.fillStyle=this.fillStyle,t.prototype.render.call(this),i.fill(),this},i}(e.Rect);i.Obstacle=n}.apply(i,n),!(void 0!==r&&(t.exports=r))}]);